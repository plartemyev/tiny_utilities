# Errors get logged to /var/log/cfn-init.log. See Also /var/log/eb-tools.log

files:
  "/etc/php.d/redis.ini" :
    mode: "000644"
    owner: root
    group: root
    content: |
      extension=redis.so
      session.save_handler = redis
      session.save_path = "tcp://sessions.wo5usz.0001.usw2.cache.amazonaws.com:6379"

packages:
  yum:
    php56-devel: []
    make: []
    gcc: []
    wget: []
    git: []

commands:
  01download_redis:
    command: "wget https://github.com/nicolasff/phpredis/zipball/master -O /tmp/phpredis.zip"
    cwd: /tmp

  02install_redis:
    command: "cp /usr/include/php/ext/igbinary /usr/local/include/php/ext/igbinary -fr && unzip -o /tmp/phpredis.zip && cd /tmp/phpredis-phpredis-* && phpize && ./configure --enable-redis-igbinary && make && make install"
    cwd: /tmp

  03restart_server:
    command: "apachectl restart"
    cwd: /tmp
